.. Generated by https://github.com/linawolf/t3docs_restructured_api_tools 
.. php:namespace::  TYPO3\CMS\Core\Resource\Security

.. php:class:: FileMetadataPermissionsAspect

   We do not have AOP in TYPO3 for now, thus the aspect which
   deals with file metadata data security is an assembly of hooks to
   check permissions on files belonging to file meta data records
   
   See source code on `GitHub <https://github.com/TYPO3/typo3/blob/main/typo3/sysext/core/Classes/Resource/Security/FileMetadataPermissionsAspect.php>`__.

   .. php:method:: checkRecordUpdateAccess()
   
      This hook is called before any write operation by DataHandler
      
      See source code on `GitHub <https://github.com/TYPO3/typo3/blob/main/typo3/sysext/core/Classes/Resource/Security/FileMetadataPermissionsAspect.php#L42>`__.
      
      
   .. php:method:: checkModifyAccessList(bool $accessAllowed, string $table, \DataHandler $parent)
   
      Hook that determines whether a user has access to modify a table.
      
      We "abuse" it here to actually check if access is allowed to sys_file_metadata.
      
      See source code on `GitHub <https://github.com/TYPO3/typo3/blob/main/typo3/sysext/core/Classes/Resource/Security/FileMetadataPermissionsAspect.php#L66>`__.
      
      :param bool $accessAllowed: Whether the user has access to modify a table
      :param string $table: The name of the table to be modified
      :param \DataHandler $parent: The calling parent object
      
   .. php:method:: isAllowedToShowEditForm()
   
      Deny access to the edit form. This is not mandatory, but better to show this right away that access is denied.
      
      See source code on `GitHub <https://github.com/TYPO3/typo3/blob/main/typo3/sysext/core/Classes/Resource/Security/FileMetadataPermissionsAspect.php#L137>`__.
